#/!bin/bash
#
# Author by Kim JiHwan (chjr68@naver.com)
#
#########################################################################################
###                                                                                   ###
###         _____  _                    _  ___  ___ _____ ______                      ###
###        /  __ \| |                  | | |  \/  |/  ___|| ___ \                     ###
###        | /  \/| |  ___   _   _   __| | | .  . |\ `--. | |_/ /                     ###
###        | |    | | / _ \ | | | | / _` | | |\/| | `--. \|  __/                      ###
###        | \__/\| || (_) || |_| || (_| | | |  | |/\__/ /| |                         ###
###         \____/|_| \___/  \__,_| \__,_| \_|  |_/\____/ \_|                         ###
###                                                                                   ###
#########################################################################################

#메인 스크립트

#절대경로
g_path=$( cd "$(dirname "$0")" ; pwd )

source ${g_path}/.ext_script/global_define.sh #전역변수 지정

#외부 패키지
source ${g_path}/.ext_script/modules/ext_package_install.sh #미들웨어 외부모듈 설치

#source ${g_path}/.ext_script/ext_modules/ext_tools_module.sh #기타 설치외 모듈

#log 관련
source ${g_path}/.ext_script/debug/debug.sh #로그파일 초기화 및 로깅

#dialog, 인터페이스 관련
source ${g_path}/.ext_script/dialog/dialog.sh #다이얼로그
source ${g_path}/.ext_script/dialog/ui_dialog_interface.sh #UI 구성

#메인설치
source ${g_path}/.ext_script/main_install.sh

jump=2 #직관성을 위해서 전역으로
Progress=0

#########################################################################################

function main()
{
    #시스템 환경변수 초기화
    source ~/.bash_profile    

    Init_Log #로그 초기화
    Write_Log $FUNCNAME $LINENO "====================================== Middleware Installation STARTS (${DEF_PRODUCT_TYPE}) ============================="
   
    BACKTITLE="Middleware Installer V1.0"
    TITLE="Middleware Auto Installer"

    #rpms.tar.gz 파일 압축 해제
    #Decompress_Rpms

    #rpms 설치 유무 확인 및 설치
    Check_Rpms_Dependency

    #실제 설치 수행
    
    Show_Menu


    #압축 해제 디렉토리 삭제
    Delete_Rpms_Directory
    
    Write_Log $FUNCNAME $LINENO "end"
}

#메인함수 호출
main $@